<html>
  <head>
    <title>MARCHING ORDERS COMMENTS</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"/>
  </head>

  <body>
    <div class="container-fluid">
      <div style="background:#ff9999 !important" class="jumbotron jumbotron-fluid">
        <div class="container">
          <h1 class='text-center'>MARCHING ORDERS</h1>
          <p class="text-center">Lorem ipsum dolor sit amet, cu stet lorem imperdiet mei, in ius saepe animal. Elit adhuc usu ad, quot mediocrem consetetur
            te nam, eos no debet repudiare moderatius. Duo ex meis natum principes, no mel dicta graeco, mea solet detracto molestie ea. Tollit platonem ius
            no, in vel minim eirmod delectus. Te novum erant nominati mea.</p>
        </div>
      </div>

      <div style="background:#cce6ff !important" class="jumbotron jumbotron-fluid">
        <input type="button" id="driver" value = "Load Data"/>
        <br>
        <select id="mySelect" onchange="myFunction()">
          <option value="topic">Category</option>
        </select><br>
        <p id="demo"></p>
        <pre id="content"></pre>
      </div>
    </div>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
      crossorigin="anonymous"></script>

    <script type = "text/javascript" language = "javascript">
      $(document).ready(function() {
        $("#driver").click(function(event){
          $.getJSON('comments_all.json', function(jd) {
            topic_list=[];
            for (i = 1; i < Object.keys(jd).length+1; i++) {
              var myArray = jd[i].Category.toLowerCase().trim().match(/[^,\s][^\,]*[^,\s]*/g);
              // alert(myArray);
              // topic_list.push(jd[i].Category);
              // alert(myArray);
              topic_list.push.apply(topic_list, myArray);
            }
            // alert(topic_list);
            var uniqueList = topic_list.filter( onlyUnique );
            uniqueList.sort();
            // alert(uniqueList);
            var myList = document.getElementById('mySelect');
            var listContent = '';
            for (i = 0; i < uniqueList.length; i++) {
              listContent = listContent + '<option value="' + uniqueList[i] + '">' + uniqueList[i] + '</option>';
            }
            myList.innerHTML = listContent;
          });
        });
        function onlyUnique(value, index, self) {
            return self.indexOf(value) == index;
        }
      });

      function listMajors(x) {
        document.getElementById('content').innerHTML = '<strong>Category</strong> =  '+ x + '\n';
        $.getJSON('comments_all.json', function(jd) {
          for (i = 1; i < Object.keys(jd).length+1; i++) {

            var myArray = jd[i].Category.toLowerCase().trim().match(/[^,\s][^\,]*[^,\s]*/g);
            // if (jd[i].Category==x) {
              // alert(x);
            if (myArray.indexOf(x) != -1) {
              var pre = document.getElementById('content');
              var textContent = document.createTextNode(jd[i]["Category"] + ":  " + jd[i]["agrees"] + " Likes   " + jd[i]["comment-body"] + '\n');
              pre.appendChild(textContent);
            }
          }
        });
      }

      function myFunction() {
        var x = document.getElementById("mySelect").value;
        document.getElementById("demo").innerHTML = 'You selected: ' + x ;
        // alert('myFunction ' + x);
        listMajors(x);
      }
    </script>
  </body>
</html>
